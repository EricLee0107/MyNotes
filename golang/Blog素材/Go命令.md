



# Go命令

## go bug

### 概述

向go的github上提交bug报告,报告中包括一些有用的系统信息



## go build

### 概述

用于编译我们指定的源码文件或代码包及他们的依赖包。当编译包时，忽略已“_test.go”结尾的文件。

### 用法

```go
go build [-o output] [-i] [build flags] [packages]
```

### 详解

#### 常用标记

- `-i`:在build过程中安装那些编译目标依赖的且未被安装的代码包。
- `-a`:强行对所有涉及道德代码包（包括标准库中的代码包）进行重新构建，即使它们已经是最新的了
- `-o`:指定输出文件的名称，当使用此标记时，不能同时对多个代码包进行编译。
- `-n`:打印编译期间所用到的其他命令，但是并不真正执行它们。
- `-v`:打印出那些被编译的代码包的名字
- `-x`:打印编译期间所用到的其他命令，并执行他们（与`-n`的差别）
- `-p n`: 指定编译过程中执行个任务的并行数量（确切的说应该是并发数量）。在默认情况下，该数量等于CPU的逻辑合数。但是在`darwin/arm`平台下，默认数量是1
- `-race`: 开启静态条件的检测
- `-work`: 打印编译时生成的临时工作目录的路径，并在编译结束时保留它。在默认情况下，编译结束时会删除该目录。

#### 不常用标记

- `-asmflags`：传递给每次go tool asm 调用的参数。此标记后可以跟另外一些标记，如`-D`、`-I`、`-s`等。这些后跟的标记用于控制Go语言编译汇编语言文件时的行为。
- `-buildmode`：此标记用于指定编译模式，使用方式如`-buildingmode=default`(这等同于默认情况下的设置)。此标记支持的编译模式目前有八种，分别是`archive` `c-archive` `c-shared` `default` `shared` `exe` `pie` `plugin` 。借此我们可以控制编译器在编译完成后生成静态链接库（即`.a`文件）、动态链接库（即`.os`文件）或`/`和可执行文件（在windows下是`.exe`文件）。
- `-compiler`：此标记用于指定当前使用的编译器的名称。其值可以为`gc`或`gccgo`。其中，gc编译器即为Go语言自带的编辑器，而gccgo编译器则为GCC提供的Go语言编译器。而GCC则是GNU项目出品的编译器套件。
- `gccgoflags`：此标记用于指定需要传递给gccgo编译器或链接器的标记的列表
- `-gcflags`：此标记用于指定传递给`go tool compile`命令的标记的列表
- `-installsuffix`：为了使当前的输出目录与默认的编译输出目录分离，可以使用这个标记。
- `-ldflags`：此标记用于指定需要传递给`go tool link`命令的标记的列表
- `-linkshared`：此标记用于与`-buildmode=shared`一同使用。后者会是做媒编译目标的非main代码包被合并到一个静态链接库文件中，而后者则会在此之上进行链接操作。
- `-mod mode`：使用的木块下载模式：`readonly` `vendor` `mod`
- `-modefile file`：在模块感知模式下，读取（并且可能写入）备用的go.mod文件，而不是在木块根目录下的go.mod文件。名字为“go.mod”的文件仍然必须存在用来确定模块根目录，但其不会被访问。当`-modfile`被指定，备用的go.sum文件也会被使用：其路径从`-modfile`标志产生，通过去除"/mod"扩展名并追加“sum”。
- `-pkgdir`：此标记用于指定一个目录。编译器会只从该目录中加载代码包的归档文件，并会把编译可能会生成的代码包归档文件放置在该目录下
- `-tags`：此标记用于指定在实际编译期间需要手里的编译标签的列表。这些编译标签一般会作为源码文件开始出的注释的一部分(在文件开始出添加注释内容)
- `-tooexec`：此标记可以让我们去自定义在编译期间使用一些go语言自带工具（如vet、asm等）的方式
- `-trimpath`：从目标可执行文件中移除所有文件系统路径。作为文件系统绝对路径的代替，记录下的文件名将以"go"（对标准库）或者“模块路径@版本”（当使用模块），或“import路径”(当使用GOPATH)开头。

## go clean

### 概述

删除执行其他命令时产生的一些文件和目录

### 用法

```go
go clean [clean flags] [build flags] [packages]
```

### 详解

#### 常用标记

- `-cache`：删除整个go build缓存
- `-i`：同时删除安装当前代码包时所产生的结果文件。如果当前代码包中只包含库源码文件，则结果文件指的就是在工作去的pkg目录的相应目录下的归档文件。如果当前代码包中只包含一个命令源码文件，则结果文件指的就是在工作区的bin目录下的可执行文件。
- `-r`：同时删除当前代码包的所依赖包的上述目录和文件。

#### 不常用标记

- `-modcache`：删除整个模块下载缓存，包括制定版本以来的已解压的源代码。
- `-n`：打印实际需要执行的命令，但不运行。
- `-testcache`：令`go build`缓存中所有测试结果过期。
- `-x`：打印实际需要执行的命令，并运行。



## go doc

### 概述

打印附于Go语言程序实体上的文档。我们可以通过把程序实体的标识符作为该命令的参数来达到查看其文档的目的。

### 详解

#### 标识

`-c`：加入此标记后，会使`go doc`命令区分参数中字母的大小写。默认情况下，命令是大小写不敏感的。

`-u`：加入此标记后，会使`go doc`命令同时打印出不可导出的程序实体的文档。默认情况下，这部分文档是不会被打印出来的。

`-cmd`：加入此标记后，会使`go doc`命令同时打印出main包中的可到处的程序实体的文档。默认情况下，这部分文档是不会被打印出来的。

`-short`：每个符号一行表示。

`-all`：显示包的所有文档。

`-src`：显示程序实体的完整源代码。这将显示其声明和定义的完整go代码，如函数定义（包括函数体），类型声明或闭包引用的常量块。输出可能因此包含未导出的细节。

## go env

### 概述

打印go的运行环境信息

### 详解

#### 标识

- `-json`：以JSON格式打印环境变量，而不是像shell脚本一样。
- `-u`：需要一个或多个参数，如果指定名字的环境变量已经使用`go evn -w`设置，则取消其默认设置。
- `-w`：需要一个或多个格式为NAME=VALUE的参数，使用指定的值修改指定名字的环境变量的默认设置。

## go fix

运行go tool fix

## go fmt

运行gofmt进行格式化

## go generate

### 概述

从processing source生成go

### 详解

## go get

### 概述

下载并安装包和依赖

### 用法

```go
go get [-d] [-t] [-u] [-v] [-insecure] [build flags] [packages]
```



### 详解

`go get`可以接受所有可用于`go build`和`go install`命令的标记。

#### 特有标记

- `-d`：让命令程序只执行下载动作，而不执行安装动作
- `-f`：仅在使用`-u`标记时才有效。该标记会让命令程序忽略掉已下载代码包的导入路径的检查。如果下载并安装的代码包所属的项目是你从别人那里Fork过来的，那么这样做就尤为重要了。
- `-fix`：让命令程序在下载代码包后限制性修正动作，而后在进行编译和安装。
- `-insecure`：允许命令程序使用非安全的scheme（如http）去下载指定的代码包。如果你用的代码仓库没有HTTPS支持，可以添加此标记。请在确定安全的情况下使用。
- `-t`：让命令程序同时下载并安装指定的代码包的测试源码文件中依赖的代码包。
- `-u`：让命令利用网络来更新已有代码包及其依赖包。默认情况下，该命令只会从网络上下载本地不存在的代码包，而不会更新已有的代码包。



## go install

### 概述

编译并安装指定的代码包及它们的依赖包。

### 用法



### 详解

## go list

### 概述

列出指定的代码包的信息。

### 用法

```go
go list [-f format] [-json] [-m] [list flags] [build flags] [packages]
```

### 标记

- `-e`：改变对错误包的处理方式，那些错误包或者不存在或者内容残缺。默认情况下，list命令会为每个错误包打印一条错误信息至标准错误输出中，然后在普通的打印中忽略这些错误包。使用`-e`标记，list命令将不会打印错误信息至标准错误输出中，而是以普通打印的方式处理错误包。错误包将非空的ImportPath和非nil的Error字段；其他信息可能会也可能不会缺失（置位零值）
- `-deps`：不只是遍历指定名字的包，也会遍历它们的依赖。list以深度优先后序遍历的方式遍历它们，因此一个包会在他的所有依赖之后列出。未在命令行中显式列出的包将有一个设置为true的DepOnly字段。
- `-export`：将Export字段设置为包含指定包最新导出信息的文件名。
- `-compiled`：将CompiledGoFiles 设置为提交给编译器的go源文件。通常，这以为着其会重复GoFiles列出的文件，然后也会添加通过处理CgoFiles和SwigFiles生成的Go代码。Imports列表包含来自GoFiles和CompiledGoFiles所有导入的并集。
- `-m`：列出模块而不是包。
- `-json`：包数据已JSON格式打印，而不是使用template包的格式。
- `-find`：找出指定名字的包，但不解析他们的依赖：Imports和Deps列表将会为空。

## go mod

### 概述



### 详解

## go run 

### 概述

编译并运行go命令

### 详解

## go test

### 概述

运行测试

### 用法

```go
go test [build/test flags] [packages] [build/test flags & test binary flags]
```

### 详解

#### 常用标记

- `-c`：生成用于运行测试的可执行文件，但不执行它。这个可执行的文件会被命名为"pkg.test"其中的"pkg"即为被测试代码包的导入路径的最后一个元素的名称。 
- `-i`：安装/重新安装隐形测试所需的依赖包，但不编译和运行测试代码。
- `-o`：指定用于运行测试的可执行文件的名称。追加该标记不会影响测试代码的运行，除非同时追加了标`-c`或者`-i`

## go tool

### 概述

运行go提供的工具

### 详解

## go version

### 概述

显示go版本



## go vet

### 概述

用于检查Go语言源码中静态错误的简单工具，是对`go tool vet`命令的简单封装。

